This is chapter 4 originating from main branch.